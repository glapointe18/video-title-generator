<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Créateur de Pages Titre Multiples</title>

<link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Cinzel+Decorative&family=Gilda+Display&family=Lobster&family=Montserrat&family=Playfair+Display&family=Roboto+Slab&display=swap" rel="stylesheet">

<style>
  body { font-family: Arial, sans-serif; padding: 20px; background: #f4f4f4; }
  h1 { margin-bottom: 20px; }
  form { margin-bottom: 20px; max-width: 600px; }
  input, select, button { display: block; margin-bottom: 10px; padding: 8px; width: 100%; }
  .preview {
    width: 800px; height: 450px; border: 2px solid #333; 
    display: flex; flex-direction: column; justify-content: center; 
    align-items: center; text-align: center; 
    background-color: black; position: relative; margin-bottom: 20px; padding: 10px;
    color: white;
  }
  .download-btn { padding: 10px 15px; cursor: pointer; max-width: 200px; margin-top: 10px; }
  #colorPalette { display:flex; gap:10px; margin-bottom:10px; align-items:center; }
  .colorSwatch { width:40px; height:40px; cursor:pointer; border:2px solid #333; border-radius:5px; }
  .colorSwatch.selected { border:3px solid #fff; }
  #customColor { width:40px; height:40px; border:none; cursor:pointer; }
</style>
</head>
<body>

<h1>Créer des Pages Titre Illimitées</h1>
<form id="titleForm">

  <h2>Informations des artistes (inchangées)</h2>
  <label>Interprète :</label>
  <input type="text" id="interpreter" required placeholder="Ex: John Doe">

  <label>Instrument / Tessiture :</label>
  <input type="text" id="instrumentTessiture" placeholder="Ex: Piano, Soprano">

  <label>Accompagnateur :</label>
  <input type="text" id="accompanist" placeholder="Ex: Jane Smith">

  <label>Instrument Accompagnateur :</label>
  <input type="text" id="instrumentAccomp" placeholder="Ex: Piano">

  <label>Text color :</label>
  <div id="colorPalette">
    <div class="colorSwatch selected" style="background:#ffffff;" data-color="#ffffff"></div>
    <div class="colorSwatch" style="background:#ffd700;" data-color="#ffd700"></div>
    <div class="colorSwatch" style="background:#00ff00;" data-color="#00ff00"></div>
    <div class="colorSwatch" style="background:#00bfff;" data-color="#00bfff"></div>
    <div class="colorSwatch" style="background:#ff69b4;" data-color="#ff69b4"></div>
    <input type="color" id="customColor" value="#ffffff">
  </div>

  <label>Choix de police :</label>
  <select id="fontChoice">
    <option value="'Gilda Display', serif">Gilda Display</option>
    <option value="'Cinzel Decorative', cursive">Cinzel Decorative</option>
    <option value="'Bebas Neue', sans-serif">Bebas Neue</option>
    <option value="'Montserrat', sans-serif">Montserrat</option>
    <option value="'Lobster', cursive">Lobster</option>
    <option value="'Roboto Slab', serif">Roboto Slab</option>
    <option value="'Playfair Display', serif">Playfair Display</option>
  </select>

  <label>Style du texte :</label>
  <select id="fontStyle">
    <option value="normal">Normal</option>
    <option value="italic">Italique</option>
    <option value="bold">Gras</option>
  </select>

  <h2>Titres / Opéra / Compositeur (illimité)</h2>
  <div id="titlesContainer">
    <div class="titleBlock">
      <label>Titre :</label><input type="text" class="videoTitle" placeholder="Ex: Sonate n°5">
      <label>Opera / Source :</label><input type="text" class="operaSource" placeholder="Ex: La Traviata">
      <label>Compositeur :</label><input type="text" class="composer" placeholder="Ex: Beethoven">
    </div>
  </div>
  <button type="button" id="addTitleBtn">Ajouter un autre titre</button>
  <button type="submit">Générer les pages</button>
</form>

<div id="previewsContainer"></div>

<script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
<script>
const form = document.getElementById('titleForm');
const previewsContainer = document.getElementById('previewsContainer');
const addTitleBtn = document.getElementById('addTitleBtn');
const titlesContainer = document.getElementById('titlesContainer');
const colorSwatches = document.querySelectorAll('.colorSwatch');
const customColorInput = document.getElementById('customColor');
let selectedColor = '#ffffff';

// Handle swatch selection
colorSwatches.forEach(swatch => {
  swatch.addEventListener('click', () => {
    colorSwatches.forEach(s => s.classList.remove('selected'));
    swatch.classList.add('selected');
    selectedColor = swatch.dataset.color;
  });
});

// Custom color picker
customColorInput.addEventListener('change', () => {
  colorSwatches.forEach(s => s.classList.remove('selected'));
  selectedColor = customColorInput.value;
});

addTitleBtn.addEventListener('click', () => {
  const newBlock = document.createElement('div');
  newBlock.className = 'titleBlock';
  newBlock.innerHTML = `
    <label>Titre :</label><input type="text" class="videoTitle" placeholder="Ex: Sonate n°5">
    <label>Opera / Source :</label><input type="text" class="operaSource" placeholder="Ex: La Traviata">
    <label>Compositeur :</label><input type="text" class="composer" placeholder="Ex: Beethoven">
  `;
  titlesContainer.appendChild(newBlock);
});

form.addEventListener('submit', (e) => {
  e.preventDefault();
  previewsContainer.innerHTML = ''; // Clear previous previews

  const interpreter = document.getElementById('interpreter').value;
  const instrumentTessiture = document.getElementById('instrumentTessiture').value;
  const accompanist = document.getElementById('accompanist').value;
  const instrumentAccomp = document.getElementById('instrumentAccomp').value;
  const fontChoice = document.getElementById('fontChoice').value;
  const fontStyle = document.getElementById('fontStyle').value;

  const titleBlocks = titlesContainer.querySelectorAll('.titleBlock');

  titleBlocks.forEach((block,index)=>{
    const videoTitle = block.querySelector('.videoTitle').value;
    const operaSource = block.querySelector('.operaSource').value;
    const composer = block.querySelector('.composer').value;

    if(!videoTitle) return;

    const previewDiv = document.createElement('div');
    previewDiv.className = 'preview';
    previewDiv.style.color = selectedColor;
    previewDiv.style.fontFamily = fontChoice;
    previewDiv.style.fontStyle = fontStyle==='italic' ? 'italic':'normal';
    previewDiv.style.fontWeight = fontStyle==='bold' ? 'bold':'normal';

    let secondLine = '';
    if(operaSource) secondLine += `<div style="font-size:42px; font-weight:normal;">${operaSource}</div>`;
    if(composer) secondLine += `<div style="font-size:42px; font-weight:normal;">${composer}</div>`;

    previewDiv.innerHTML = `
      <div style="font-size:42px; font-weight:bold; font-style:italic;">${videoTitle}</div>
      ${secondLine}<br><br>
      <div style="font-size:31px;">${[interpreter, instrumentTessiture].filter(Boolean).join(', ')}</div>
      <div style="font-size:31px;">${[accompanist, instrumentAccomp].filter(Boolean).join(', ')}</div>
      <button class="download-btn">Télécharger cette page</button>
    `;
    previewsContainer.appendChild(previewDiv);

    const downloadBtn = previewDiv.querySelector('button');
    downloadBtn.addEventListener('click', ()=>{
      html2canvas(previewDiv, { scale: 5 }).then(canvas => {
        const link = document.createElement('a');
        link.download = `page-titre-${index+1}.png`;
        link.href = canvas.toDataURL();
        link.click();
      });
    });
  });
});
</script>
</body>
</html>
